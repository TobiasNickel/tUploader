tUploader=function(f){function l(a){a.stopPropagation();a.preventDefault()}function q(a){a.stopPropagation();a.preventDefault();console.log("dragOver");c.autoDroparea&&(e.style.display="block")}function m(a){a.stopPropagation();a.preventDefault();e.style.display="none"}function n(a){e.style.display="none";a.files=[];for(var b=a.dataTransfer.files.length;b--;)a.files.push(a.dataTransfer.files[b]);if(c.acceptedFileExtensions)for(b=a.files.length;b--;){var d=a.files[b].name.slice(a.files[b].name.lastIndexOf("."));
-1==c.acceptedFileExtensions.indexOf(d)&&a.files.splice(b,1)}c.preprocess(a,function(b){b||(b={});if(a.files.length){b.path=b.path||c.stdUploadPath;a.stopPropagation();a.preventDefault();a.bitrate=new tStabilizer(5);c.uploads.push(a);for(var d=a.files,f=new FormData,h=0;h<d.length;h++){var k=d[h];f.append("files[]",k,k.name)}k="";if(b.get)for(h in b.get)k+=(k.length?"":"?")+h+b.get[h];if(b.post)for(h in post)f.append(h,post[h]);var e=new XMLHttpRequest;e.open("POST",b.path+(k.length?k:""),!0);e.onload=
function(){200===e.status?(c.uploads.splice(c.uploads.indexOf(a),1),c.trigger("progress",{event:a,progress:1,bitrate:0}),c.trigger("success",{event:a})):c.trigger("error",{event:a})};c.trigger("start",{event:a});var g=0,l=0;e.upload.addEventListener("progress",function(b){var d=b.loaded/b.total,e=parseInt((b.loaded-g)/(b.timeStamp-l));a.bitrate.push(e);a.total=b.total;a.loaded=b.loaded;a.progress=d;c.trigger("progress",{event:b,progress:d,bitrate:a.bitrate.getAvarage(),globalProgress:c.getGlobalProgress()});
g=b.loaded;l=b.timeStamp});e.send(f);c.trigger("begin",{files:d})}})}tStabilizer=function(a){a=a||Infinity;this.values=[];this.push=function(b){for(this.values.push(b);this.values.length>a;)this.values.shift()};this.getAvarage=function(){return this.getSum()/this.values.length};this.getMax=function(){for(var b=-Infinity,a=this.values.length;a--;)b=b<this.values[a]?this.values[a]:b;return b};this.getMin=function(){for(var b=Infinity,a=this.values.length;a--;)b=b>this.values[a]?this.values[a]:b;return b};
this.getSum=function(){for(var b=0,a=this.values.length;a--;)b+=this.values[a];return b}};var p=null,g=f.createElement("input");g.setAttribute("type","file");g.setAttribute("multiple","true");g.onchange=function(){n({dataTransfer:{files:g.files},stopPropagation:function(){},preventDefault:function(){}})};var e=f.createElement("div");e.setAttribute("style","position:fixed;top:0px;bottom:0px;right:0px; left:0px; z-index:100; background-color:rgba(255,255,50,0.6);border:brown dashed 3px;display:none; margin:0px; ");
window.addEventListener("load",function(){p=f.body;p.appendChild(e);f.addEventListener("dragenter",l,!1);f.addEventListener("dragstart",l,!1);e.addEventListener("dragleave",m,!1);f.addEventListener("dragend",m,!1);f.addEventListener("dragover",q,!1);f.addEventListener("drop",n,!1)});var c={openFilebrowser:function(){g.click()},preprocess:function(a,b){b({})},stdUploadPath:"upload.json",getGlobalProgress:function(){for(var a=0,b=0,d=0;d<this.uploads.length;d++)a+=this.uploads[d].progress*this.uploads[d].total,
b+=this.uploads[d].total;return 0==a&&0==b?1:a/b},setAccept:function(a){g.setAttribute("accept",a);if(a)switch(a){case "imgage/*":this.acceptedFileExtensions=".jpg,.jpeg,.png,.gif,.tif,.bmp";break;case "audio/*":this.acceptedFileExtensions=".mp3,.mp4,.odd,.wav";break;default:this.acceptedFileExtensions=a}else this.acceptedFileExtensions=null},acceptedFileExtensions:null,input:g,uploads:[],autoDropareaElement:e,autoDroparea:!0};(function(a){a._events={};a.on=function(b,a){b=b.toLowerCase();b in this._events||
(this._events[b]=[]);-1===this._events[b].indexOf(a)&&this._events[b].push(a)};a.off=function(a,d){a?d?delete this._events[a][this._events[a].indexOf(d)]:delete this._events[a]:this._events={}};a.trigger=function(a,d){if(a&&this._events[a])for(var c=this._events[a].length;c--;)this._events[a][c](d)}})(c);return c}(document);