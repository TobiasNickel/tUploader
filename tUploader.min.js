(function(c){function k(b){b.stopPropagation();b.preventDefault()}function p(b){b.stopPropagation();b.preventDefault();console.log("dragOver");tUploader.autoDroparea&&(g.style.display="block")}function l(b){b.stopPropagation();b.preventDefault();g.style.display="none"}function m(b){tUploader.preprocess(b,function(a){a||(a={});g.style.display="none";a.path=a.path||tUploader.stdUploadPath;b.stopPropagation();b.preventDefault();for(var h=b.dataTransfer.files,c=new FormData,e=0;e<h.length;e++){var f=
h[e];c.append("files[]",f,f.name)}f="";if(a.get)for(e in a.get)f+=(f.length?"":"?")+e+a.get[e];if(a.post)for(e in post)c.append(e,post[e]);var d=new XMLHttpRequest;d.open("POST",a.path+(f.length?f:""),!0);d.onload=function(){200===d.status?(tUploader.trigger("progress",{files:h,event:b,progress:1,bitrate:0}),tUploader.trigger("success",{files:h})):tUploader.trigger("error",{files:h})};var k=0,l=0;d.upload.addEventListener("progress",function(a){var b=a.loaded/a.total,c=parseInt((a.loaded-k)/(a.timeStamp-
l));tUploader.trigger("progress",{files:h,event:a,progress:b,bitrate:c});k=a.loaded;l=a.timeStamp});d.send(c);tUploader.trigger("begin",{files:h})})}var n=null,d=c.createElement("input");d.setAttribute("type","file");d.setAttribute("multiple","true");d.onchange=function(){m({dataTransfer:{files:d.files},stopPropagation:function(){},preventDefault:function(){}})};var g=c.createElement("div");g.setAttribute("style","position:fixed;top:0px;bottom:0px;right:0px; left:0px; z-index:100; background-color:rgba(255,255,50,0.6);border:brown dashed 3px;display:none; margin:0px; ");
window.addEventListener("load",function(){n=c.body;n.appendChild(g);c.addEventListener("dragenter",k,!1);c.addEventListener("dragstart",k,!1);g.addEventListener("dragleave",l,!1);c.addEventListener("dragend",l,!1);c.addEventListener("dragover",p,!1);c.addEventListener("drop",m,!1)});window.tUploader={openFilebrowser:function(){d.click()},preprocess:function(b,a){a({})},stdUploadPath:"upload.json",autoDropareaElement:g,autoDroparea:!0};(function(b){b._events={};b.on=function(a,b){a=a.toLowerCase();
a in this._events||(this._events[a]=[]);-1===this._events[a].indexOf(b)&&this._events[a].push(b)};b.off=function(a,b){a?b?delete this._events[a][this._events[a].indexOf(b)]:delete this._events[a]:this._events={}};b.trigger=function(a,b){if(a&&this._events[a])for(var c=this._events[a].length;c--;)this._events[a][c](b)}})(window.tUploader)})(document);